syntax = "proto3";

package nft;

// For more information on gogo.proto, see:
// https://github.com/gogo/protobuf/blob/master/extensions.md
import "github.com/gogo/protobuf/gogoproto/gogo.proto";


enum ActionKind {
    Transfer = 0;
    Usage = 1;
    UpdateDetails = 2;
}

message NonFungibleToken {
    bytes id = 1;
    bytes owner = 2;
    repeated Approval approvals = 3;
    TokenDetails details = 4;
}

message TokenDetails {
    oneof payload {
        HumanAddressDetails humanAddress = 1;
        BlockChainDetails blockchain = 2;
        ContractDetails token = 3;
    }
}

message Approval {
    bytes toAccount = 1;
    ActionKind action = 2;
    ApprovalOptions options = 3;
}

message ApprovalOptions {
    int64 timeout = 1; // nanos. todo: revisit to use block height?, if this is time then this may not be deterministic enough
    int64 count = 2; // usage count
    bool immutilbe = 3; // todo: immutable ? immutability of the right not the data
}


message HumanAddressDetails {
    bytes account = 1; // anything for the spike
}

message BlockChainDetails {
    repeated Node nodes = 1 [(gogoproto.nullable) = false];
    bytes chainID = 2;
}

message ContractDetails {
    bytes account = 1; // anything for the spike
}

message Node {
    string name = 1;
}


// base messages
//

message RequestTransferTokenMsg {
    bytes id = 1;
    bytes newOwner = 2;
}

message SetApprovalMsg {
    bytes id = 1;
    Approval approvals = 2; // todo: Can be `repeated`
}

message RevokeApprovalMsg {
    bytes toAccount = 1;
    ActionKind action = 2;
    string comment = 3;
}

message RevokeTokenMsg {
    bytes id = 1;
    string comment = 2;
}
